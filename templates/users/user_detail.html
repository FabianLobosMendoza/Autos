{% extends "base/base.html" %}

{% block title %}Detalle de usuario{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
    <h3 class="mb-0">Usuario: {{ user.username }}</h3>
    <div class="btn-group align-items-center">
        <a href="{% url 'edit_user_profile' user.id %}" class="btn btn-sm btn-outline-primary">Editar</a>
        <a href="{% url 'change_user_password' user.id %}" class="btn btn-sm btn-outline-secondary">Cambiar contrasena</a>
        <form method="post" action="{% url 'update_user_role' user.id %}" class="d-flex align-items-center">
            {% csrf_token %}
            <select name="role" class="form-select form-select-sm border-primary text-body fw-semibold"
                    onchange="this.form.submit()"
                    style="min-width: 190px; height: 2rem;">
                <option value="usuario" {% if profile.role == 'usuario' %}selected{% endif %}>Usuario</option>
                <option value="vendedor" {% if profile.role == 'vendedor' %}selected{% endif %}>Vendedor oficial de cuentas</option>
                <option value="supervisor" {% if profile.role == 'supervisor' %}selected{% endif %}>Supervisor</option>
                <option value="admin" {% if profile.role == 'admin' %}selected{% endif %}>Administrador</option>
            </select>
        </form>
        <a href="{% url 'delete_user' user.id %}" class="btn btn-sm btn-outline-danger">Eliminar</a>
    </div>
</div>

<div class="card mb-3">
    <div class="card-body">
        <h5 class="card-title">Datos basicos</h5>
        <p><strong>Nombre:</strong> {{ user.first_name }} {{ user.last_name }}</p>
        <p><strong>Email:</strong> {{ user.email }}</p>
        <p><strong>Rol:</strong> {{ profile.get_role_display }}</p>
    </div>
</div>

<div class="card">
    <div class="card-body">
        <h5 class="card-title">Perfil</h5>
        <p><strong>Telefono:</strong> {{ profile.phone }}</p>
        <p><strong>Fecha de nacimiento:</strong> {{ profile.birthdate }}</p>
        <p><strong>Direccion:</strong> {{ profile.address }}</p>
        <p><strong>Notas:</strong> {{ profile.notes }}</p>
    </div>
</div>

<div class="mt-3">
    <a href="{% url 'user_list' %}" class="btn btn-link">Volver al listado</a>
</div>
{% endblock %}
